<html>
  <head>
    <link rel="stylesheet" href="./style.sheet.css" />
  </head>
  <body>
    <script type="text/javascript">
      window.onload = async () => {
        var [headers, rows] = await Promise.all([
          fetch(
            "https://spreadsheets.google.com/feeds/cells/1qS2o3JQ07qFkUXMBvEZVZ3E8Z_mk0jMXXhxJkQ35LR8/o1a4hmz/public/basic?alt=json&min-row=1&max-row=1"
          )
            .then(r => r.json())
            .then(json => json.feed.entry.map(e => e.content.$t)),
          fetch(
            "https://spreadsheets.google.com/feeds/list/1qS2o3JQ07qFkUXMBvEZVZ3E8Z_mk0jMXXhxJkQ35LR8/o1a4hmz/public/values?alt=json"
          )
            .then(r => r.json())
            .then(json =>
              json.feed.entry.map(e => [
                e.title.$t,
                ...e.content.$t.split(", ").map(i => i.split(": ")[1].trim())
              ])
            )
        ]);

        function insertCell(value, td = "td") {
          return `<${td}>${value}</${td}>`;
        }

        function insertRow(row, className = "", td) {
          return `<tr class='${className}'>${row
            .map((c, i) => (i !== 11 && i !== 14 ? insertCell(c, td) : ""))
            .join("")}</tr>`;
        }

        const today = new Date().getDate();
        document.getElementById("prayer_times").innerHTML = `
          <table class='table'>
            <thead>${insertRow(headers, "headerRow", "th")}</thead>
            <tbody>${rows
              .map(row =>
                insertRow(row, row[0] == today ? "selectedTableRow" : "")
              )
              .join("")}</tbody>
          </table>
        `;
      };
    </script>

    <div id="prayer_times"></div>
  </body>
</html>
