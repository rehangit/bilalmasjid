<html>
  <head> </head>
  <body>
    <script type="text/javascript">
      window.onload = async () => {
        var [headers, rows] = await fetch(
          "https://sheets.googleapis.com/v4/spreadsheets/1qS2o3JQ07qFkUXMBvEZVZ3E8Z_mk0jMXXhxJkQ35LR8/values/formatted!A:O?key=AIzaSyCq_9F8lfiTeXuj0RoPTrOg0NufmVf6qts"
        )
          .then(res => res.json())
          .then(json => [json.values[0], json.values.slice(1)]);

        function insertCell(value, td = "td", i) {
          if (i !== 11 && i !== 14) {
            const [hh, mm] = value.split(":");
            if (i > 5 && mm) {
              const h = Number(hh);
              if (h < 12) value = h + 12 + ":" + mm;
            }
            return `<${td}>${value}</${td}>`;
          }
          return "";
        }

        function insertRow(row, className = "", td) {
          return `<tr class='${className}'>${row
            .map((c, i) => insertCell(c, td, i))
            .join("")}</tr>`;
        }

        const today = new Date().getDate();
        document.getElementById("prayer_times").innerHTML = `
          <table class='table'>
            <thead>${insertRow(headers, "headerRow", "th")}</thead>
            <tbody>${rows
              .map(row =>
                insertRow(row, row[0] == today ? "selectedTableRow" : "")
              )
              .join("")}</tbody>
          </table>
        `;
      };
    </script>

    <style>
      body {
        margin: 0;
        font-family: Lato, "Trebuchet MS", "Lucida Sans Unicode",
          "Lucida Grande", "Lucida Sans", sans-serif;
      }

      .table {
        width: calc(100%-4px);
        text-align: center;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        border-collapse: collapse;
        margin: auto;
      }
      .selectedTableRow {
        background-color: slategray;
        color: whitesmoke;
      }
      td,
      th {
        text-align: center;
        border: 0.25px rgba(128, 128, 128, 0.5) solid;
        padding: 4px 4px;
        font-size: inherit;
      }
      th:first-child,
      td:first-child {
        text-align: left;
      }

      @media only screen and (max-width: 600px) {
        td,
        th {
          font-size: small;
          padding: 2px 2px;
        }
      }

      .table thead th {
        background-color: darkolivegreen;
        color: white;
      }
      .table thead,
      .table thead th {
        position: sticky;
        position: -webkit-sticky;
        top: 0;
      }
    </style>

    <div id="prayer_times"></div>
  </body>
</html>
